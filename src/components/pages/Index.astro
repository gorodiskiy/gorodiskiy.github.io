---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import { useTranslations, useTranslatedPath } from '../../i18n/utils';

interface Props {
	lang: 'uk' | 'ru';
}

const { lang } = Astro.props;
const t = useTranslations(lang);
const translatePath = useTranslatedPath(lang);

const posts = (await getCollection('blog', ({ id }) => {
	return id.startsWith(`${lang}/`);
}))
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 3);
---

<BaseLayout title={t('hero.title') + " | Front-End Developer"}>
	<section id="home" class="hero">
		<!-- Декоративные фигуры -->
		<div class="shapes-container">
			<div class="shape dots" style="top: 10%; left: 10%;" data-speed="2"></div>
			<div class="shape triangle" style="top: 20%; right: 15%;" data-speed="-3"></div>
			<div class="shape squiggle" style="bottom: 25%; left: 15%;" data-speed="4"></div>
			<div class="shape circle" style="bottom: 10%; right: 10%;" data-speed="-2"></div>
			
			<div class="shape ring" style="top: 40%; left: 5%;" data-speed="5"></div>
			<div class="shape square" style="top: 15%; left: 45%;" data-speed="-4"></div>
			<div class="shape plus" style="bottom: 40%; right: 12%;" data-speed="3"></div>
			<div class="shape triangle" style="top: 60%; left: 20%; transform: rotate(120deg);" data-speed="-2"></div>
			<div class="shape circle" style="top: 30%; right: 30%;" data-speed="6"></div>
			<div class="shape dots" style="bottom: 15%; left: 40%;" data-speed="-3"></div>
			<div class="shape squiggle" style="top: 50%; right: 5%;" data-speed="2"></div>
			<div class="shape ring" style="bottom: 50%; left: 10%;" data-speed="-5"></div>
		</div>

		<div class="hero-content">
			<img src="/images/avatar.png" alt={t('hero.title')} class="profile-img" />
			
			<h1>{t('hero.title')}</h1>
			<p>{t('hero.desc')}</p>

			<div class="social-links">
				<a href="#" title="Instagram"><i class="icon-social-instagram"></i></a>
				<a href="#" title="Twitter"><i class="icon-social-twitter"></i></a>
				<a href="#" title="Behance"><i class="icon-social-behance"></i></a>
				<a href="#" title="Dribbble"><i class="icon-social-dribbble"></i></a>
				<a href="#" title="Pinterest"><i class="icon-social-pinterest"></i></a>
			</div>

			<a href="#contact" class="btn-hire">{t('hero.hire')}</a>

			<div class="scroll-down">
				<span>{t('hero.scroll')}</span>
				<div class="mouse"></div>
			</div>
		</div>
	</section>

	<section id="blog" class="latest-posts section-padding">
		<div class="container">
			<h2 class="section-title">{t('blog.latest')}</h2>
			<div class="post-grid">
				{
					posts.map((post) => {
						const slug = post.slug.split('/').pop();
						return (
						<article class="post-card-home">
							<div class="post-thumb">
								<a href={translatePath(`/blog/${slug}/`)}>
									<span class="category">{post.data.category}</span>
									<img src={post.data.heroImage} alt={post.data.title} />
								</a>
							</div>
							<div class="post-details">
								<h3 class="post-title">
									<a href={translatePath(`/blog/${slug}/`)}>{post.data.title}</a>
								</h3>
								<ul class="post-meta">
									<li>{post.data.pubDate.toLocaleDateString(lang === 'uk' ? 'uk-UA' : 'ru-RU', { day: 'numeric', month: 'long', year: 'numeric' })}</li>
									<li>Bolby</li>
								</ul>
							</div>
						</article>
						);
					})
				}
			</div>
		</div>
	</section>
</BaseLayout>
